<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>TÃ¼rkiye Cami Rehberi</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
:root { --yesil: #14532d; --altin: #fbbf24; }
body { margin:0; font-family: sans-serif; background:#052c14; color:#fff; }
header { background: var(--yesil); padding:10px; text-align:center; border-bottom:2px solid var(--altin); }
.controls { padding:10px; display:flex; flex-direction:column; gap:10px; }
input, select { padding:12px; border-radius:20px; border:1px solid var(--altin); width:100%; box-sizing:border-box; }
.btn { background: var(--altin); color:#000; padding:12px; border-radius:20px; font-weight:bold; border:none; cursor:pointer; }
#map { height: calc(100vh - 280px); width:100%; }
.nav-btn { display:block; background:#2563eb; color:#fff; padding:10px; text-align:center; text-decoration:none; border-radius:5px; margin-top:5px; }
</style>
</head>
<body>
<header><h1>ğŸ•Œ Cami Rehberi</h1></header>
<div class="controls">
    <select id="ilSelect"><option value="">Ä°l SeÃ§iniz...</option></select>
    <input type="text" id="ara" placeholder="ğŸ” Cami ismi ara..." onkeyup="aramaYap()">
    <button class="btn" onclick="enYakiniBul()">ğŸ“ En YakÄ±n Camiyi Bul</button>
</div>
<div id="map"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const iller = ["Adana", "AdÄ±yaman", "Afyonkarahisar", "AÄŸrÄ±", "Amasya", "Ankara", "Antalya", "Artvin", "AydÄ±n", "BalÄ±kesir", "Bilecik", "BingÃ¶l", "Bitlis", "Bolu", "Burdur", "Bursa", "Ã‡anakkale", "Ã‡ankÄ±rÄ±", "Ã‡orum", "Denizli", "DiyarbakÄ±r", "Edirne", "ElazÄ±ÄŸ", "Erzincan", "Erzurum", "EskiÅŸehir", "Gaziantep", "Giresun", "GÃ¼mÃ¼ÅŸhane", "Hakkari", "Hatay", "Isparta", "Mersin", "Ä°stanbul", "Ä°zmir", "Kars", "Kastamonu", "Kayseri", "KÄ±rklareli", "KÄ±rÅŸehir", "Kocaeli", "Konya", "KÃ¼tahya", "Malatya", "Manisa", "KahramanmaraÅŸ", "Mardin", "MuÄŸla", "MuÅŸ", "NevÅŸehir", "NiÄŸde", "Ordu", "Rize", "Sakarya", "Samsun", "Siirt", "Sinop", "Sivas", "TekirdaÄŸ", "Tokat", "Trabzon", "Tunceli", "ÅanlÄ±urfa", "UÅŸak", "Van", "Yozgat", "Zonguldak", "Aksaray", "Bayburt", "Karaman", "KÄ±rÄ±kkale", "Batman", "ÅÄ±rnak", "BartÄ±n", "Ardahan", "IÄŸdÄ±r", "Yalova", "KarabÃ¼k", "Kilis", "Osmaniye", "DÃ¼zce"];
const s = document.getElementById("ilSelect");
iller.sort().forEach(i => { let o = document.createElement("option"); o.value=i; o.text=i; s.add(o); });

const map = L.map('map').setView([39, 35], 6);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
let markers = [], myLoc = null;

map.locate({setView: false});
map.on('locationfound', e => { myLoc = e.latlng; L.marker(e.latlng).addTo(map).bindPopup("BuradasÄ±nÄ±z"); });

s.onchange = function() {
    if(!this.value) return;
    markers.forEach(m => map.removeLayer(m));
    markers = [];
    const q = `[out:json][timeout:25];area["name"="${this.value}"]["admin_level"="4"]->.a;(node["amenity"="place_of_worship"]["religion"="muslim"](area.a);way["amenity"="place_of_worship"]["religion"="muslim"](area.a););out center;`;
    fetch("https://overpass-api.de/api/interpreter", {method:"POST", body:q}).then(res=>res.json()).then(data=>{
        data.elements.forEach(el => {
            const lat = el.lat || el.center.lat, lon = el.lon || el.center.lon, is = el.tags.name || "Ä°simsiz Cami";
            const m = L.circleMarker([lat, lon], {radius:8, color:'#14532d', fillColor:'#fbbf24', fillOpacity:0.9})
            .bindPopup(`<b>${is}</b><a class="nav-btn" target="_blank" href="https://www.google.com/maps/dir/?api=1&destination=${lat},${lon}">ğŸš— Yol Tarifi</a>`);
            m.is = is.toLowerCase(); markers.push(m); m.addTo(map);
        });
        if(markers.length) map.fitBounds(L.featureGroup(markers).getBounds());
    });
};

function aramaYap() {
    const v = document.getElementById("ara").value.toLowerCase();
    markers.forEach(m => { if(m.is.includes(v)) m.addTo(map); else map.removeLayer(m); });
}

function enYakiniBul() {
    if(!myLoc || !markers.length) return alert("Konum veya veri yok!");
    let n = markers.reduce((p, c) => myLoc.distanceTo(c.getLatLng()) < myLoc.distanceTo(p.getLatLng()) ? c : p);
    map.setView(n.getLatLng(), 16); n.openPopup();
}
</script>
</body>
</html>
