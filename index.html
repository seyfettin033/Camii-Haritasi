<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TÃ¼rkiye Cami Rehberi - Navigasyon</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <style>
        :root { --yesil: #064e3b; --altin: #fbbf24; --beyaz: #ffffff; --kirmizi: #e30a17; }
        body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #022c22; color: white; overflow: hidden; }
        
        /* BayraklÄ± Ãœst Panel */
        .header { 
            background: linear-gradient(to bottom, var(--yesil), #022c22); 
            padding: 15px; 
            text-align: center; 
            border-bottom: 3px solid var(--altin);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        .flag-row { display: flex; align-items: center; gap: 10px; font-size: 24px; }
        .turk-bayragi { width: 40px; height: auto; border-radius: 3px; box-shadow: 0 0 10px rgba(0,0,0,0.5); }
        
        /* Kontrol Paneli */
        .pnl { padding: 10px; display: flex; flex-direction: column; gap: 8px; background: rgba(255,255,255,0.05); }
        select, input, .btn { padding: 12px; border-radius: 12px; border: 1px solid var(--altin); font-size: 15px; width: 100%; box-sizing: border-box; outline: none; }
        input { background: white; color: black; }
        .btn { background: var(--altin); color: black; font-weight: bold; cursor: pointer; border: none; transition: 0.3s; }
        .btn:active { transform: scale(0.98); }
        
        #map { height: calc(100vh - 310px); width: 100%; }
        
        /* Navigasyon Butonu */
        .nav-link { display: block; background: #2563eb; color: white !important; padding: 12px; text-align: center; text-decoration: none; border-radius: 8px; margin-top: 10px; font-weight: bold; }
        footer { position: fixed; bottom: 0; width: 100%; background: black; padding: 8px; text-align: center; font-size: 11px; color: #888; }
    </style>
</head>
<body>

<div class="header">
    <div class="flag-row">
        <span>ğŸ•Œ</span>
        <img src="https://upload.wikimedia.org/wikipedia/commons/b/b4/Flag_of_Turkey.svg" class="turk-bayragi" alt="TR">
        <span>ğŸ•Œ</span>
    </div>
    <h1 style="margin:0; font-size: 18px; color: var(--altin);">TÃœRKÄ°YE CAMÄ° REHBERÄ°</h1>
</div>

<div class="pnl">
    <select id="ilSec">
        <option value="">LÃ¼tfen Bir Åehir SeÃ§in...</option>
    </select>
    <input type="text" id="aramaKutusu" placeholder="ğŸ” Cami ismi ara (Ã–rn: Ulu Cami)" onkeyup="filtrele()">
    <button class="btn" onclick="enYakiniBul()">ğŸ“ KONUMUMA EN YAKIN CAMÄ°YÄ° BUL</button>
</div>

<div id="map"></div>

<footer>
    Â© 2026 TÃ¼rkiye Cami Veri TabanÄ± - Navigasyon Sistemi
</footer>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const iller = ["Adana", "AdÄ±yaman", "Afyonkarahisar", "AÄŸrÄ±", "Amasya", "Ankara", "Antalya", "Artvin", "AydÄ±n", "BalÄ±kesir", "Bilecik", "BingÃ¶l", "Bitlis", "Bolu", "Burdur", "Bursa", "Ã‡anakkale", "Ã‡ankÄ±rÄ±", "Ã‡orum", "Denizli", "DiyarbakÄ±r", "Edirne", "ElazÄ±ÄŸ", "Erzincan", "Erzurum", "EskiÅŸehir", "Gaziantep", "Giresun", "GÃ¼mÃ¼ÅŸhane", "Hakkari", "Hatay", "Isparta", "Mersin", "Ä°stanbul", "Ä°zmir", "Kars", "Kastamonu", "Kayseri", "KÄ±rklareli", "KÄ±rÅŸehir", "Kocaeli", "Konya", "KÃ¼tahya", "Malatya", "Manisa", "KahramanmaraÅŸ", "Mardin", "MuÄŸla", "MuÅŸ", "NevÅŸehir", "NiÄŸde", "Ordu", "Rize", "Sakarya", "Samsun", "Siirt", "Sinop", "Sivas", "TekirdaÄŸ", "Tokat", "Trabzon", "Tunceli", "ÅanlÄ±urfa", "UÅŸak", "Van", "Yozgat", "Zonguldak", "Aksaray", "Bayburt", "Karaman", "KÄ±rÄ±kkale", "Batman", "ÅÄ±rnak", "BartÄ±n", "Ardahan", "IÄŸdÄ±r", "Yalova", "KarabÃ¼k", "Kilis", "Osmaniye", "DÃ¼zce"];
    const ilSec = document.getElementById("ilSec");
    iller.sort((a,b)=>a.localeCompare('tr')).forEach(il => {
        let o = document.createElement("option"); o.value = il; o.text = il; ilSec.add(o);
    });

    const map = L.map('map').setView([39, 35], 6);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    
    let markers = [];
    let cihazKonum = null;

    map.locate({setView: false});
    map.on('locationfound', e => {
        cihazKonum = e.latlng;
        L.marker(e.latlng).addTo(map).bindPopup("<b>BuradasÄ±nÄ±z</b>").openPopup();
    });

    ilSec.onchange = function() {
        const il = this.value;
        if(!il) return;

        markers.forEach(m => map.removeLayer(m));
        markers = [];

        const sorgu = `[out:json][timeout:60];area["name"="${il}"]["admin_level"="4"]->.a;(node["amenity"="place_of_worship"]["religion"="muslim"](area.a);way["amenity"="place_of_worship"]["religion"="muslim"](area.a););out center;`;
        
        fetch("https://overpass-api.de/api/interpreter", {method: "POST", body: sorgu})
        .then(res => res.json())
        .then(data => {
            data.elements.forEach(el => {
                const lat = el.lat || el.center.lat;
                const lon = el.lon || el.center.lon;
                const isim = el.tags.name || "Ä°simsiz Cami";

                const m = L.circleMarker([lat, lon], {
                    radius: 9, color: '#064e3b', fillColor: '#fbbf24', fillOpacity: 1
                }).bindPopup(`
                    <div style="color:black; text-align:center;">
                        <strong style="font-size:14px;">${isim}</strong><br>
                        <a class="nav-link" target="_blank" href="https://www.google.com/maps/dir/?api=1&destination=${lat},${lon}">ğŸš— YOL TARÄ°FÄ° AL</a>
                    </div>
                `);
                m.camiAdi = isim.toLowerCase();
                markers.push(m);
                m.addTo(map);
            });
            if(markers.length > 0) map.fitBounds(L.featureGroup(markers).getBounds());
        })
        .catch(err => alert("BaÄŸlantÄ± hatasÄ±! LÃ¼tfen ÅŸehri tekrar seÃ§in."));
    };

    function filtrele() {
        const kelime = document.getElementById("aramaKutusu").value.toLowerCase();
        markers.forEach(m => {
            if(m.camiAdi.includes(kelime)) m.addTo(map);
            else map.removeLayer(m);
        });
    }

    function enYakiniBul() {
        if(!cihazKonum) { alert("Konumunuz alÄ±namadÄ±. LÃ¼tfen GPS/Konum izni verin."); return; }
        if(markers.length === 0) { alert("LÃ¼tfen Ã¶nce bir ÅŸehir seÃ§in."); return; }

        let enYakin = markers[0];
        let enKisaMesafe = cihazKonum.distanceTo(markers[0].getLatLng());

        markers.forEach(m => {
            let d = cihazKonum.distanceTo(m.getLatLng());
            if(d < enKisaMesafe) { enKisaMesafe = d; enYakin = m; }
        });

        map.setView(enYakin.getLatLng(), 17);
        enYakin.openPopup();
    }
</script>
</body>
</html>
